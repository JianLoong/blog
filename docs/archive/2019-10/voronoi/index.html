<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.76.5" />
    <meta name="description" content="">


    <link rel="icon" href="/blog/images/favicon.ico" type="image/ico">

    <title>Voronoi Diagram :: Jian Liew</title>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-55422968-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    <link href="/blog/css/nucleus.css?1603606236" rel="stylesheet">
    <link href="/blog/css/fontawesome-all.min.css?1603606236" rel="stylesheet">
    <link href="/blog/css/hybrid.css?1603606236" rel="stylesheet">
    <link href="/blog/css/featherlight.min.css?1603606236" rel="stylesheet">
    <link href="/blog/css/perfect-scrollbar.min.css?1603606236" rel="stylesheet">
    <link href="/blog/css/auto-complete.css?1603606236" rel="stylesheet">
    <link href="/blog/css/atom-one-dark-reasonable.css?1603606236" rel="stylesheet">
    <link href="/blog/css/theme.css?1603606236" rel="stylesheet">
    <link href="/blog/css/hugo-theme.css?1603606236" rel="stylesheet">
    
      <link href="/blog/css/theme-blue.css?1603606236" rel="stylesheet">
    

    <script src="/blog/js/jquery-3.3.1.min.js?1603606236"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/blog/archive/2019-10/voronoi/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://jianliew.me/blog">
  Jian
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/blog/js/lunr.min.js?1603606236"></script>
<script type="text/javascript" src="/blog/js/auto-complete.js?1603606236"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/jianliew.me\/blog";
    
</script>
<script type="text/javascript" src="/blog/js/search.js?1603606236"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/blog/entries/" title="Blog" class="dd-item
        
        
        
        ">
      <a href="/blog/entries/">
          <b></b>Blog
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            


 
  
    
    <li data-nav-id="/blog/entries/2019-11/" title="November 2019" class="dd-item
        
        
        
        ">
      <a href="/blog/entries/2019-11/">
          <b></b>November 2019
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/blog/entries/2019-11/firestore/" title="Nested Data in Documents (FireStore)" class="dd-item ">
        <a href="/blog/entries/2019-11/firestore/">
        <b>&nbsp;1st. </b>Nested Data in Documents (FireStore)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/entries/2019-11/singletonobserverpattern/" title="Singleton &amp; Observer Pattern (Java)" class="dd-item ">
        <a href="/blog/entries/2019-11/singletonobserverpattern/">
        <b>&nbsp;3th. </b>Singleton &amp; Observer Pattern (Java)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/entries/2019-11/javascriptsort/" title="JavaScript Sort Stability" class="dd-item ">
        <a href="/blog/entries/2019-11/javascriptsort/">
        <b>&nbsp;4th. </b>JavaScript Sort Stability
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/entries/2019-11/minmax/" title="Min and Max value of an Array (Java)" class="dd-item ">
        <a href="/blog/entries/2019-11/minmax/">
        <b>&nbsp;6th. </b>Min and Max value of an Array (Java)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/entries/2019-11/programmingtoaninterface/" title="Programming to an Interface (Java)" class="dd-item ">
        <a href="/blog/entries/2019-11/programmingtoaninterface/">
        <b>&nbsp;7th. </b>Programming to an Interface (Java)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/entries/2019-11/foreignkeys/" title="Foreign Key Constraint" class="dd-item ">
        <a href="/blog/entries/2019-11/foreignkeys/">
        <b>&nbsp;9th. </b>Foreign Key Constraint
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/blog/archive/" title="Archive" class="dd-item
        parent
        
        
        ">
      <a href="/blog/archive/">
          <b></b>Archive
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            


 
  
    
    <li data-nav-id="/blog/archive/2019-10/" title="October 2019" class="dd-item
        parent
        
        
        ">
      <a href="/blog/archive/2019-10/">
          <b></b>October 2019
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/guard/" title="Explicit Else (Guard)" class="dd-item ">
        <a href="/blog/archive/2019-10/guard/">
        <b>&nbsp;1st. </b>Explicit Else (Guard)
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/percentage/" title="Reddit Chart" class="dd-item ">
        <a href="/blog/archive/2019-10/percentage/">
        <b>&nbsp;9th. </b>Reddit Chart
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/programmming/" title="Reddit Word Cloud " class="dd-item ">
        <a href="/blog/archive/2019-10/programmming/">
        <b>12th. </b>Reddit Word Cloud 
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/hk/" title="Sentiment Analysis" class="dd-item ">
        <a href="/blog/archive/2019-10/hk/">
        <b>13th. </b>Sentiment Analysis
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/topstories/" title="Hacker News Word Cloud " class="dd-item ">
        <a href="/blog/archive/2019-10/topstories/">
        <b>14th. </b>Hacker News Word Cloud 
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/ga/" title="Genetic Algorithm" class="dd-item ">
        <a href="/blog/archive/2019-10/ga/">
        <b>19th. </b>Genetic Algorithm
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/tsp/" title="TSP using GA" class="dd-item ">
        <a href="/blog/archive/2019-10/tsp/">
        <b>23th. </b>TSP using GA
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/promiseall/" title="Promise All" class="dd-item ">
        <a href="/blog/archive/2019-10/promiseall/">
        <b>25th. </b>Promise All
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/nearestneighbour/" title="k-Nearest Neighbour on Maps" class="dd-item ">
        <a href="/blog/archive/2019-10/nearestneighbour/">
        <b>27th. </b>k-Nearest Neighbour on Maps
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/java13/" title="Java 13 on Ubuntu" class="dd-item ">
        <a href="/blog/archive/2019-10/java13/">
        <b>28th. </b>Java 13 on Ubuntu
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/blog/archive/2019-10/voronoi/" title="Voronoi Diagram" class="dd-item active">
        <a href="/blog/archive/2019-10/voronoi/">
        <b>29th. </b>Voronoi Diagram
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://jianliew.me/blog/cv"><i class='far fa-file fa-fw'></i>&nbsp;Curriculum Vitae</a>
              </li>
          
              <li>
                  <a class="padding" href="https://jianliew.me/blog/timeline"><i class='fas fa-history fa-fw'></i>&nbsp;Time Line</a>
              </li>
          
              <li>
                  <a class="padding" href="https://jianliew.me/blog/tags"><i class='fas fa-tags fa-fw'></i>&nbsp;Tags</a>
              </li>
          
              <li>
                  <a class="padding" href="https://jianliew.me/blog/disclaimer"><i class='fas fa-exclamation-triangle fa-fw'></i>&nbsp;Disclaimer</a>
              </li>
          
              <li>
                  <a class="padding" href="https://github.com/JianLoong"><i class='fab fa-github fa-fw'></i>&nbsp;GitHub Repo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://au.linkedin.com/in/jian-loong-liew-0433ab39"><i class='fab fa-linkedin-in fa-fw'></i>&nbsp;Linkedin</a>
              </li>
          
              <li>
                  <a class="padding" href="mailto:jianloongliew@gmail.com"><i class='fas fa-envelope-square fa-fw'></i>&nbsp;Email</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/blog/'>Contents</a> > <a href='/blog/archive/'>Archive</a> > <a href='/blog/archive/2019-10/'>October 2019</a> > Voronoi Diagram
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
<div class="tags">

  <a class="tag-link" href="/blog/tags/nearest-neighbour">Nearest Neighbour</a>

  <a class="tag-link" href="/blog/tags/maps">Maps</a>

  <a class="tag-link" href="/blog/tags/voronoi">Voronoi</a>

</div>

        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Voronoi Diagram
            </h1>
          

        









  <p>Posted on: <strong> Sunday, October 13, 2019</strong></p>

<p>Reading time: <strong>5 minutes and
    7 seconds.</strong></p>
<hr />


<script src="https://unpkg.com/d3@5.12.0/dist/d3.min.js"></script>
<script src="/blog/scripts/d3-delaunay.min.js"></script>

<div class="notices note" ><p>One of the most common query when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.</p>
</div>

<p>Below is an example of a Voronoi diagram generated using d3.js. One of the good use case of a voronoi diagram in real life applications would be where would be <strong>finding a place to build emergency services.</strong> This place should have the most number of neighbouring regions. For example, if you <code>click</code> on the region in the voronoi diagram below, you can see how many regions in which it would consider this region to be its neighbour. The diagram is randomly generated based on a number of points and thus every refresh of this page will show a different voronoi diagram.</p>
<div id="canvas" style="text-align:center;max-width:30em;margin:auto;"></div>
<p align="center"><strong>Fig 1. Voronoi Diagram generated with 30 random points</strong></p>
<!-- <embed src="https://www.desmos.com/calculator/q0nyt99bcr?embed" width="100%" height="500px" style="border: 1px solid #ccc" frameborder=0></embed> -->
<p>The codes to create this diagram are as follows :-</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">createVoronoi</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">width</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">600</span>;
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">height</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">600</span>;
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">vertices</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">range</span>(<span style="color:#ae81ff">30</span>).<span style="color:#a6e22e">map</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">d</span>) {
    <span style="color:#66d9ef">return</span> [Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#a6e22e">width</span>, Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">*</span> <span style="color:#a6e22e">height</span>];
  });

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">delaunay</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">Delaunay</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">vertices</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">voronoi</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">delaunay</span>.<span style="color:#a6e22e">voronoi</span>([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">height</span>]);
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">svg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>
    .<span style="color:#a6e22e">select</span>(<span style="color:#e6db74">&#34;#canvas&#34;</span>)
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;svg&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;viewBox&#34;</span>, <span style="color:#e6db74">`0 0 600 600`</span>);

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mesh</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">svg</span>
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;path&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#e6db74">&#34;none&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke&#34;</span>, <span style="color:#e6db74">&#34;#ccc&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke-width&#34;</span>, <span style="color:#ae81ff">1</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#a6e22e">voronoi</span>.<span style="color:#a6e22e">render</span>());

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bounds</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">svg</span>
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;path&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#e6db74">&#34;none&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke&#34;</span>, <span style="color:#e6db74">&#34;#ccc&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke-width&#34;</span>, <span style="color:#ae81ff">1</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#a6e22e">voronoi</span>.<span style="color:#a6e22e">renderBounds</span>());

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">points</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">svg</span>
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;path&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#e6db74">&#34;black&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke&#34;</span>, <span style="color:#e6db74">&#34;#ccc&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke-width&#34;</span>, <span style="color:#ae81ff">1</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#a6e22e">delaunay</span>.<span style="color:#a6e22e">renderPoints</span>());
};
</code></pre></div><h4 id="example-of-a-query">Example of a query</h4>
<p>I will now re-use my data set of point from an earlier blog entry and I will generate the voronoi diagram. Basically, I would use a query point as well to find out the nearest neighbour and the surrounding neighbours. The figure below shows that the d3-delaunay provides a simple functions that allows you to find the point in which is the closest to the query point. This is done by using <code>delaunay.find()</code>. So if you are <strong>inside the blue region</strong>, your closest point would be the point inside the blue region.</p>
<p>It&rsquo;s surrounding neighbours could then be easily obtained once you have this point by using <code>delaunay.neighbor()</code> and passing the result of the first find function. So, the regions which are in teal would be the <strong>neighbours of the region in blue</strong>. All the other regions would be coloured in green. This simple data structure would allow you to easily obtain the nearest neighbour. However, of course, there is also the importance of the build time, insertion time and removal time as well.</p>
<div id="exampleQuery" style="text-align:center;max-width:30em;margin:auto;"></div>
<p align="center"><strong>Fig 2. Voronoi Diagram for a NN query.</strong></p>
<h5 id="the-codes-to-create-this-diagram-are-as-follows">The codes to create this diagram are as follows</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">queryExample</span> <span style="color:#f92672">=</span> () =&gt; {
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">points</span> <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">74</span>],
    [<span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">118</span>],
    [<span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">87</span>],
    [<span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">93</span>],
    [<span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">104</span>],
    [<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">96</span>],
    [<span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">122</span>],
    [<span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">71</span>]
  ];

  <span style="color:#75715e">// Function to transform the points so that it would work on the grid
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">transform</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">point</span> =&gt; {
    <span style="color:#66d9ef">return</span> [(<span style="color:#a6e22e">point</span>[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">90</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">500</span>, (<span style="color:#a6e22e">point</span>[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">180</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">500</span>];
  };

  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">transformed</span> <span style="color:#f92672">=</span> [];

  <span style="color:#a6e22e">points</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">element</span> =&gt; {
    <span style="color:#a6e22e">transformed</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">transform</span>(<span style="color:#a6e22e">element</span>));
  });

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">delaunay</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">Delaunay</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">points</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">voronoi</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">delaunay</span>.<span style="color:#a6e22e">voronoi</span>([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">500</span>, <span style="color:#ae81ff">500</span>]);

  <span style="color:#75715e">// Call the draw Voronoi function.
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">drawVoronoi</span>(<span style="color:#e6db74">&#34;#exampleQuery&#34;</span>, <span style="color:#a6e22e">transformed</span>);
};

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">drawVoronoi</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">vertices</span>, <span style="color:#a6e22e">color</span>) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">width</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>,
    <span style="color:#a6e22e">height</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>;

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">delaunay</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">Delaunay</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">vertices</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">voronoi</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">delaunay</span>.<span style="color:#a6e22e">voronoi</span>([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">width</span>, <span style="color:#a6e22e">height</span>]);
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">svg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d3</span>
    .<span style="color:#a6e22e">select</span>(<span style="color:#a6e22e">id</span>)
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;svg&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;viewBox&#34;</span>, <span style="color:#e6db74">`0 0 500 500`</span>);

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">mesh</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">svg</span>
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;path&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#e6db74">&#34;none&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke&#34;</span>, <span style="color:#e6db74">&#34;#ccc&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke-width&#34;</span>, <span style="color:#ae81ff">1</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#a6e22e">voronoi</span>.<span style="color:#a6e22e">render</span>());

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bounds</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">svg</span>
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;path&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#e6db74">&#34;none&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke&#34;</span>, <span style="color:#e6db74">&#34;#ccc&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke-width&#34;</span>, <span style="color:#ae81ff">1</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#a6e22e">voronoi</span>.<span style="color:#a6e22e">renderBounds</span>());

  <span style="color:#75715e">// Find the closest point to this coordinate.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ans</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">delaunay</span>.<span style="color:#a6e22e">find</span>(<span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">73</span>);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">neighbours</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">delaunay</span>.<span style="color:#a6e22e">neighbors</span>(<span style="color:#a6e22e">ans</span>);
  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iterator</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">neighbours</span>) {
    <span style="color:#a6e22e">renderCell</span>(<span style="color:#a6e22e">svg</span>, <span style="color:#a6e22e">voronoi</span>, <span style="color:#a6e22e">iterator</span>, <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">schemeTableau10</span>[<span style="color:#ae81ff">3</span>]);
  }

  <span style="color:#a6e22e">renderCell</span>(<span style="color:#a6e22e">svg</span>, <span style="color:#a6e22e">voronoi</span>, <span style="color:#a6e22e">ans</span>, <span style="color:#a6e22e">d3</span>.<span style="color:#a6e22e">schemeTableau10</span>[<span style="color:#ae81ff">0</span>]);
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">points</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">svg</span>
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;path&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#e6db74">&#34;black&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke&#34;</span>, <span style="color:#e6db74">&#34;#ccc&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke-width&#34;</span>, <span style="color:#ae81ff">1</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#a6e22e">delaunay</span>.<span style="color:#a6e22e">renderPoints</span>());
};

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">renderCell</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">svg</span>, <span style="color:#a6e22e">voronoi</span>, <span style="color:#a6e22e">index</span>, <span style="color:#a6e22e">color</span>) =&gt; {
  <span style="color:#a6e22e">svg</span>
    .<span style="color:#a6e22e">append</span>(<span style="color:#e6db74">&#34;path&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;fill&#34;</span>, <span style="color:#a6e22e">color</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke&#34;</span>, <span style="color:#e6db74">&#34;#ccc&#34;</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;stroke-width&#34;</span>, <span style="color:#ae81ff">1</span>)
    .<span style="color:#a6e22e">attr</span>(<span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#a6e22e">voronoi</span>.<span style="color:#a6e22e">renderCell</span>(<span style="color:#a6e22e">index</span>));
};
</code></pre></div><h4 id="lessons-from-this-blog-post">Lessons from this blog post.</h4>
<ul>
<li>The learning curve for d3.js is <strong>pretty insane.</strong></li>
<li>Voronois are pretty easy using d3.</li>
<li>Generators can be iterated using the for&hellip;of construct. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators">MDN link</a></li>
<li>There is a way to make SVG responsive. Refer <a href="https://medium.com/@louisemoxy/a-simple-way-to-make-d3-js-charts-svgs-responsive-7afb04bc2e4b">this</a> post.</li>
</ul>
<!-- https://bl.ocks.org/aaizemberg/raw/8063f8c2d1adb7c7ee68/ -->
<!-- https://observablehq.com/@d3/circle-dragging-iii?collection=@d3/d3-delaunay -->
<script>

const queryExample = () => {
    
    let points = [[40,74],[34,118],[41,87],[44,93],[39,104],[32,96]
    ,[47,122],[42,71]];

    const transform = point => {
        return [point[0]/90 * 500, point[1]/180*500];
    }

    let transformed = [];
    points.forEach(element => {
        transformed.push(transform(element));
    });
    
    const delaunay = d3.Delaunay.from(points);
    const voronoi = delaunay.voronoi([0, 0, 500, 500]);
    drawVoronoi("#exampleQuery", transformed);
}


const renderCell = (svg, voronoi, index, color) => {
   svg.append("path")
        .attr("fill", color)
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.renderCell(index));   
}

const drawVoronoi = (id, vertices, color) => {
    const width = 500, height = 500;
    const delaunay = d3.Delaunay.from(vertices);
    const voronoi = delaunay.voronoi([0, 0, 500, 500]);
    let svg = d3.select(id)
        .append("svg")
        .attr("viewBox", `0 0 500 500`);
        //.attr("width", width)
        //.attr("height", height);
    
    const mesh = svg.append("path")
        .attr("fill", "none")
        .attr("stroke", "#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.render());

    const bounds = svg.append("path")
        .attr("fill", "none")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.renderBounds());

    const ans = delaunay.find(40,73);

    for (let index = 0; index < vertices.length; index++) {
        const element = vertices[index];
        renderCell(svg, voronoi, index, d3.schemeTableau10[4]);
    }

    const neighbours = delaunay.neighbors(ans);
    for (const iterator of neighbours) {
        renderCell(svg, voronoi, iterator, d3.schemeTableau10[3]);
    };
     
    renderCell(svg, voronoi, ans, d3.schemeTableau10[0]);
    const points = svg.append("path")
        .attr("fill", "black")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", delaunay.renderPoints());
};

const drawExampleVoronoi = () => {

    const width = 600, height = 600;
    // const vertices = d3.range(30).map(function(d) {
    //     return [Math.random() * width, Math.random() * height];
    // });

    const radius = 10;
    const circles = d3.range(30).map(i => ({
        x: Math.random() * (width - radius * 2) + radius,
        y: Math.random() * (height - radius * 2) + radius,
    }));

    const delaunay = d3.Delaunay.from(circles, d => d.x, d => d.y);
    const voronoi = delaunay.voronoi([0, 0, width, height]);

    
    let svg = d3.select("#canvas")
        .append("svg")
        .attr("viewBox", `0 0 600 600`);
        // .attr("width", width)
        // .attr("height", height);

    // const circle = svg.append("g")
    // .selectAll("circle")
    // .data(circles)
    // .join("circle")
    //   .attr("cx", d => d.x)
    //   .attr("cy", d => d.y)
    //   .attr("r", radius)
    //   .attr("fill", "black");
    
    const mesh = svg.append("path")
        .attr("fill", "none")
        .attr("stroke", "#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.render());

    const bounds = svg.append("path")
        .attr("fill", "none")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", voronoi.renderBounds());

    // for (let index = 0; index < 10; index++) {
    //     svg.append("path")
    //     .attr("fill", d3.schemeTableau10[index % 10])
    //     .attr("stroke","#ccc")
    //     .attr("stroke-width", 1)
    //     .attr("d", voronoi.renderCell(index));
    // }; 

    const points = svg.append("path")
        .attr("fill", "black")
        .attr("stroke","#ccc")
        .attr("stroke-width", 1)
        .attr("d", delaunay.renderPoints());
};


const drawVoronoiWithPoints = (id, noOfPoints) => {

    let selected = undefined;
    
    const width = 1000, height = 1000;  
    const circles = d3.range(30).map(function(d) {
        return [Math.random() * width, Math.random() * height];
    });

    const query = [Math.random() * width,
        Math.random() * height ];

    const delaunay = d3.Delaunay.from(circles);
    const voronoi = delaunay.voronoi([0, 0, width, height]);

    let svg = d3.select(id)
        .append("svg")
        .attr("viewBox", `0 0 1000 1000`);
     
    const mesh = svg.append("path")
        .attr("fill", "none")
        .attr("stroke", "#ccc")
        .attr("stroke-width", 5)
        .attr("d", voronoi.render());

    const bounds = svg.append("path")
        .attr("fill", "none")
        .attr("stroke","#ccc")
        .attr("stroke-width", 5)
        .attr("d", voronoi.renderBounds());

    const points = () =>  svg.append("path")
        .attr("fill", "black")
        .attr("stroke","#ccc")
        .attr("stroke-width", 2)
        .attr("d", delaunay.renderPoints());

    points();

    svg.on("click", function() {
        var coords = d3.mouse(this);
        //mesh();
        if (selected != undefined){
            renderCell(svg, voronoi, selected, "white"); 
            
            for (const iterator of delaunay.neighbors(selected)) 
                renderCell(svg, voronoi, iterator, "white");
            selected = undefined;
        }

        const ans = (delaunay.find(coords[0],coords[1]));
        selected = ans;
        renderCell(svg, voronoi, ans, d3.schemeTableau10[0]);
   
        points();
        //console.log(ans);
        const neighbours = delaunay.neighbors(ans);
        for (const iterator of neighbours) {
            renderCell(svg, voronoi, iterator, d3.schemeTableau10[3]);
        };  
    });
};


//drawExampleVoronoi();
queryExample();
drawVoronoiWithPoints("#canvas",30);

</script>


<footer class=" footline" >
	
</footer>


        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/blog/archive/2019-10/java13/" title="Java 13 on Ubuntu"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/blog/archive/2019-10/guard/" title="Explicit Else (Guard)" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/blog/js/clipboard.min.js?1603606236"></script>
    <script src="/blog/js/perfect-scrollbar.min.js?1603606236"></script>
    <script src="/blog/js/perfect-scrollbar.jquery.min.js?1603606236"></script>
    <script src="/blog/js/jquery.sticky.js?1603606236"></script>
    <script src="/blog/js/featherlight.min.js?1603606236"></script>
    <script src="/blog/js/highlight.pack.js?1603606236"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/blog/js/modernizr.custom-3.6.0.js?1603606236"></script>
    <script src="/blog/js/learn.js?1603606236"></script>
    <script src="/blog/js/hugo-learn.js?1603606236"></script>

    <link href="/blog/mermaid/mermaid.css?1603606236" rel="stylesheet" />
    <script src="/blog/mermaid/mermaid.js?1603606236"></script>
    <script>
        mermaid.initialize({
          startOnLoad: true,
          flowchart : {
            curve: 'basis'
          },
          classDiagram: {
            htmlLabels: true
          }
        });
    </script>
    

  </body>
</html>

