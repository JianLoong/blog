<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.59.1"><meta name=description content><link rel=icon href=/blog/images/favicon.ico type=image/ico><title>Nested Data in Documents (FireStore) :: Jian Liew</title><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-55422968-1','auto');ga('send','pageview');}</script><link href=/blog/css/nucleus.css?1573286962 rel=stylesheet><link href=/blog/css/fontawesome-all.min.css?1573286962 rel=stylesheet><link href=/blog/css/hybrid.css?1573286962 rel=stylesheet><link href=/blog/css/featherlight.min.css?1573286962 rel=stylesheet><link href=/blog/css/perfect-scrollbar.min.css?1573286962 rel=stylesheet><link href=/blog/css/auto-complete.css?1573286962 rel=stylesheet><link href=/blog/css/atom-one-dark-reasonable.css?1573286962 rel=stylesheet><link href=/blog/css/theme.css?1573286962 rel=stylesheet><link href=/blog/css/hugo-theme.css?1573286962 rel=stylesheet><link href=/blog/css/theme-blue.css?1573286962 rel=stylesheet><script src=/blog/js/jquery-3.3.1.min.js?1573286962></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/blog/blog/november-2019/firestore/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://jianliew.me/blog>Jian</a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/blog/js/lunr.min.js?1573286962></script><script type=text/javascript src=/blog/js/auto-complete.js?1573286962></script><script type=text/javascript>var baseurl="https:\/\/jianliew.me\/blog";</script><script type=text/javascript src=/blog/js/search.js?1573286962></script></div><div class=highlightable><ul class=topics><li data-nav-id=/blog/blog/ title=Blog class="dd-item
parent"><a href=/blog/blog/><b></b>Blog</a><ul><li data-nav-id=/blog/blog/november-2019/ title="November 2019" class="dd-item
parent"><a href=/blog/blog/november-2019/><b></b>November 2019</a><ul><li data-nav-id=/blog/blog/november-2019/firestore/ title="Nested Data in Documents (FireStore)" class="dd-item active"><a href=/blog/blog/november-2019/firestore/><b>1st. </b>Nested Data in Documents (FireStore)</a></li><li data-nav-id=/blog/blog/november-2019/singletonobserverpattern/ title="Singleton &amp; Observer Pattern (Java)" class=dd-item><a href=/blog/blog/november-2019/singletonobserverpattern/><b>3th. </b>Singleton &amp; Observer Pattern (Java)</a></li><li data-nav-id=/blog/blog/november-2019/javascriptsort/ title="JavaScript Sort Stability" class=dd-item><a href=/blog/blog/november-2019/javascriptsort/><b>4th. </b>JavaScript Sort Stability</a></li><li data-nav-id=/blog/blog/november-2019/minmax/ title="Min and Max value of an Array (Java)" class=dd-item><a href=/blog/blog/november-2019/minmax/><b>6th. </b>Min and Max value of an Array (Java)</a></li><li data-nav-id=/blog/blog/november-2019/programmingtoaninterface/ title="Programming to an Interface (Java)" class=dd-item><a href=/blog/blog/november-2019/programmingtoaninterface/><b>7th. </b>Programming to an Interface (Java)</a></li><li data-nav-id=/blog/blog/november-2019/foreignkeys/ title="Foreign Key Constraint" class=dd-item><a href=/blog/blog/november-2019/foreignkeys/><b>9th. </b>Foreign Key Constraint</a></li></ul></li></ul></li><li data-nav-id=/blog/thepragmatic/ title="Pragmatic Programmer" class=dd-item><a href=/blog/thepragmatic/><b></b>Pragmatic Programmer</a><ul><li data-nav-id=/blog/thepragmatic/rubberduck/ title="Rubber Duck" class=dd-item><a href=/blog/thepragmatic/rubberduck/><b>1. </b>Rubber Duck</a></li></ul></li><li data-nav-id=/blog/teaching/ title=Teaching class=dd-item><a href=/blog/teaching/><b></b>Teaching</a><ul><li data-nav-id=/blog/teaching/ubuntu/ title=Ubuntu class=dd-item><a href=/blog/teaching/ubuntu/><b></b>Ubuntu</a><ul><li data-nav-id=/blog/teaching/ubuntu/ls/ title="The File System" class=dd-item><a href=/blog/teaching/ubuntu/ls/><b>1. </b>The File System</a></li></ul></li><li data-nav-id=/blog/teaching/uml/ title=UML class=dd-item><a href=/blog/teaching/uml/><b></b>UML</a></li></ul></li><li data-nav-id=/blog/archive/ title=Archive class=dd-item><a href=/blog/archive/><b></b>Archive</a><ul><li data-nav-id=/blog/archive/october-2019/ title="October 2019" class=dd-item><a href=/blog/archive/october-2019/><b></b>October 2019</a><ul><li data-nav-id=/blog/archive/october-2019/guard/ title="Explicit Else (Guard)" class=dd-item><a href=/blog/archive/october-2019/guard/><b>1st. </b>Explicit Else (Guard)</a></li><li data-nav-id=/blog/archive/october-2019/percentage/ title="Reddit Chart" class=dd-item><a href=/blog/archive/october-2019/percentage/><b>9th. </b>Reddit Chart</a></li><li data-nav-id=/blog/archive/october-2019/programmming/ title="Reddit Word Cloud" class=dd-item><a href=/blog/archive/october-2019/programmming/><b>12th. </b>Reddit Word Cloud</a></li><li data-nav-id=/blog/archive/october-2019/hk/ title="Sentiment Analysis" class=dd-item><a href=/blog/archive/october-2019/hk/><b>13th. </b>Sentiment Analysis</a></li><li data-nav-id=/blog/archive/october-2019/topstories/ title="Hacker News Word Cloud" class=dd-item><a href=/blog/archive/october-2019/topstories/><b>14th. </b>Hacker News Word Cloud</a></li><li data-nav-id=/blog/archive/october-2019/ga/ title="Genetic Algorithm" class=dd-item><a href=/blog/archive/october-2019/ga/><b>19th. </b>Genetic Algorithm</a></li><li data-nav-id=/blog/archive/october-2019/tsp/ title="TSP using GA" class=dd-item><a href=/blog/archive/october-2019/tsp/><b>23th. </b>TSP using GA</a></li><li data-nav-id=/blog/archive/october-2019/promiseall/ title="Promise All" class=dd-item><a href=/blog/archive/october-2019/promiseall/><b>25th. </b>Promise All</a></li><li data-nav-id=/blog/archive/october-2019/nearestneighbour/ title="k-Nearest Neighbour on Maps" class=dd-item><a href=/blog/archive/october-2019/nearestneighbour/><b>27th. </b>k-Nearest Neighbour on Maps</a></li><li data-nav-id=/blog/archive/october-2019/java13/ title="Java 13 on Ubuntu" class=dd-item><a href=/blog/archive/october-2019/java13/><b>28th. </b>Java 13 on Ubuntu</a></li><li data-nav-id=/blog/archive/october-2019/voronoi/ title="Voronoi Diagram" class=dd-item><a href=/blog/archive/october-2019/voronoi/><b>29th. </b>Voronoi Diagram</a></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://jianliew.me/blog/cv><i class="far fa-file fa-fw"></i>&nbsp;Curriculum Vitae</a></li><li><a class=padding href=https://jianliew.me/blog/timeline><i class="fas fa-history fa-fw"></i>&nbsp;Time Line</a></li><li><a class=padding href=https://jianliew.me/blog/tags><i class="fas fa-tags fa-fw"></i>&nbsp;Tags</a></li><li><a class=padding href=https://jianliew.me/blog/disclaimer><i class="fas fa-exclamation-triangle fa-fw"></i>&nbsp;Disclaimer</a></li><li><a class=padding href=https://github.com/JianLoong><i class="fab fa-github fa-fw"></i>&nbsp;GitHub Repo</a></li><li><a class=padding href=https://au.linkedin.com/in/jian-loong-liew-0433ab39><i class="fab fa-linkedin-in fa-fw"></i>&nbsp;Linkedin</a></li><li><a class=padding href=mailto:jianloongliew@gmail.com><i class="fas fa-envelope-square fa-fw"></i>&nbsp;Email</a></li></ul></section><section id=footer><p>Built with <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/blog/>Contents</a> > <a href=/blog/blog/>Blog</a> > <a href=/blog/blog/november-2019/>November 2019</a> > Nested Data in Documents (FireStore)</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#avoid-using-time-as-document-id>Avoid using Time as Document ID</a><ul><li><a href=#references>References</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/blog/tags/swift>Swift</a>
<a class=tag-link href=/blog/tags/datetime>DateTime</a>
<a class=tag-link href=/blog/tags/design>Design</a>
<a class=tag-link href=/blog/tags/document-database>Document Database</a></div></div><div id=body-inner><h1>Nested Data in Documents (FireStore)</h1><div class="notices note"><p>When using <strong>Google Firestore</strong>, there is a need to put some thought into the way the data is structure. Each option would have an advantage or limitations <strong>depending on the use case.</strong></p></div><p>With JSON being everywhere, there are times when there is a need to figure out how to structure data in the Cloud Firestore.</p><p>Here are a few common options.</p><ul><li>Nested data in documents</li><li>Subcollections</li><li>Root-level</li></ul><div class="notices warning"><p>The most important thing to remember that there is <strong>no perfect</strong> solution for structuring a Cloud Firestore database. The best and correct solution often times would be the solution that fis the needs and makes the job easier.</p></div><table><thead><tr><th align=left>Type</th><th align=left>Advantages</th><th align=left>Limitations</th></tr></thead><tbody><tr><td align=left>Nested</td><td align=left>Easy to set up</td><td align=left>Nested documents isn&rsquo;t as scalable as other</td></tr><tr><td align=left>Sub-collections</td><td align=left>Full query capability on sub-collections.</td><td align=left>Cannot easily delete sub-collections</td></tr><tr><td align=left>Root-level collections</td><td align=left>Most flexible and most scalable long with powerful query capability.</td><td align=left>Getting data becomes more complex as data grows</td></tr></tbody></table><h3 id=avoid-using-time-as-document-id>Avoid using Time as Document ID</h3><p>One of the common things I have seen is that some developers often use a <strong>date</strong> or <strong>datetime</strong> as their document id as their collection name. There are actually several reasons this should not be done. (This is especially true for FireStore)</p><ul><li>Document IDs <strong>should not</strong> be monotonically increasing such as<ul><li>Customer1, Customer2, Customer3, &hellip;.</li><li>Product1, Product2, Product3, &hellip;.</li><li>2019-01-01, 2019-01,02, 2019-01-03,&hellip;</li></ul></li><li>Sequential IDs can lead to <strong>hotspots</strong>.</li><li><strong>Document IDs are Strings</strong> and parsing Strings are often times very troublesome.<ul><li>For example, how would you query all documents on February? It would be super hard if they were stored as a String data type and you would be doing a lot of String transformations which is processor intensive and not needed at all. Document IDs in FireStore should <strong>not</strong> be stored as a date.</li></ul></li><li><strong>FireStore Queries.</strong> One of the benefits of FireStore is that allows you to write better queries in comparison to Firebase, thus if there is a field with the datatype of timestamp, it would allow you to do <strong>range queries</strong> on that field itself. This can only be done if the data type is <strong>timestamp</strong>.</li><li><strong>Time-zone.</strong> Depending on your use case, time zones play a very important factor. For example, if you are collecting data from a sensor, which time becomes important? Would it be Firebase Server time or would it be the time where the sensor itself is? What happens when Day Light Saving happens? Thus, it would always be a better idea to keep the time stamp with a time zone correctly.</li></ul><h4 id=references>References</h4><ol><li>Firebase. (2019). Choose a data structure | Firebase. [online] Available at: <a href=https://firebase.google.com/docs/firestore/manage-data/structure-data>https://firebase.google.com/docs/firestore/manage-data/structure-data</a> [Accessed 1 Nov. 2019].</li><li>Firebase. (2019). Perform simple and compound queries in Cloud Firestore | Firebase. [online] Available at: <a href=https://firebase.google.com/docs/firestore/query-data/queries>https://firebase.google.com/docs/firestore/query-data/queries</a> [Accessed 1 Nov. 2019].</li></ol><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/blog/blog/november-2019/ title="November 2019"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/blog/blog/november-2019/singletonobserverpattern/ title="Singleton &amp; Observer Pattern (Java)" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/blog/js/clipboard.min.js?1573286962></script><script src=/blog/js/perfect-scrollbar.min.js?1573286962></script><script src=/blog/js/perfect-scrollbar.jquery.min.js?1573286962></script><script src=/blog/js/jquery.sticky.js?1573286962></script><script src=/blog/js/featherlight.min.js?1573286962></script><script src=/blog/js/highlight.pack.js?1573286962></script><script>hljs.initHighlightingOnLoad();</script><script src=/blog/js/modernizr.custom-3.6.0.js?1573286962></script><script src=/blog/js/learn.js?1573286962></script><script src=/blog/js/hugo-learn.js?1573286962></script><link href=/blog/mermaid/mermaid.css?1573286962 rel=stylesheet><script src=/blog/mermaid/mermaid.js?1573286962></script><script>mermaid.initialize({startOnLoad:true,flowchart:{curve:'basis'},classDiagram:{htmlLabels:true}});</script></body></html>