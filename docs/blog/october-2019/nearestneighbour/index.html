<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.59.1"><meta name=description content><link rel=icon href=/blog/images/favicon.ico type=image/ico><title>k-Nearest Neighbour on Maps :: Jian Liew</title><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-55422968-1','auto');ga('send','pageview');}</script><link href=/blog/css/nucleus.css?1572777884 rel=stylesheet><link href=/blog/css/fontawesome-all.min.css?1572777884 rel=stylesheet><link href=/blog/css/hybrid.css?1572777884 rel=stylesheet><link href=/blog/css/featherlight.min.css?1572777884 rel=stylesheet><link href=/blog/css/perfect-scrollbar.min.css?1572777884 rel=stylesheet><link href=/blog/css/auto-complete.css?1572777884 rel=stylesheet><link href=/blog/css/atom-one-dark-reasonable.css?1572777884 rel=stylesheet><link href=/blog/css/theme.css?1572777884 rel=stylesheet><link href=/blog/css/hugo-theme.css?1572777884 rel=stylesheet><link href=/blog/css/theme-blue.css?1572777884 rel=stylesheet><script src=/blog/js/jquery-3.3.1.min.js?1572777884></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/blog/blog/october-2019/nearestneighbour/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://jianliew.me/blog>Jian</a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/blog/js/lunr.min.js?1572777884></script><script type=text/javascript src=/blog/js/auto-complete.js?1572777884></script><script type=text/javascript>var baseurl="https:\/\/jianliew.me\/blog";</script><script type=text/javascript src=/blog/js/search.js?1572777884></script></div><div class=highlightable><ul class=topics><li data-nav-id=/blog/blog/ title=Blog class="dd-item
parent"><a href=/blog/blog/><b></b>Blog</a><ul><li data-nav-id=/blog/blog/october-2019/ title="October 2019" class="dd-item
parent"><a href=/blog/blog/october-2019/><b></b>October 2019</a><ul><li data-nav-id=/blog/blog/october-2019/guard/ title="Explicit Else (Guard)" class=dd-item><a href=/blog/blog/october-2019/guard/><b>1st. </b>Explicit Else (Guard)</a></li><li data-nav-id=/blog/blog/october-2019/percentage/ title="Reddit Chart" class=dd-item><a href=/blog/blog/october-2019/percentage/><b>9th. </b>Reddit Chart</a></li><li data-nav-id=/blog/blog/october-2019/programmming/ title="Reddit Word Cloud" class=dd-item><a href=/blog/blog/october-2019/programmming/><b>12th. </b>Reddit Word Cloud</a></li><li data-nav-id=/blog/blog/october-2019/hk/ title="Sentiment Analysis" class=dd-item><a href=/blog/blog/october-2019/hk/><b>13th. </b>Sentiment Analysis</a></li><li data-nav-id=/blog/blog/october-2019/topstories/ title="Hacker News Word Cloud" class=dd-item><a href=/blog/blog/october-2019/topstories/><b>14th. </b>Hacker News Word Cloud</a></li><li data-nav-id=/blog/blog/october-2019/ga/ title="Genetic Algorithm" class=dd-item><a href=/blog/blog/october-2019/ga/><b>19th. </b>Genetic Algorithm</a></li><li data-nav-id=/blog/blog/october-2019/tsp/ title="TSP using GA" class=dd-item><a href=/blog/blog/october-2019/tsp/><b>23th. </b>TSP using GA</a></li><li data-nav-id=/blog/blog/october-2019/promiseall/ title="Promise All" class=dd-item><a href=/blog/blog/october-2019/promiseall/><b>25th. </b>Promise All</a></li><li data-nav-id=/blog/blog/october-2019/nearestneighbour/ title="k-Nearest Neighbour on Maps" class="dd-item active"><a href=/blog/blog/october-2019/nearestneighbour/><b>27th. </b>k-Nearest Neighbour on Maps</a></li><li data-nav-id=/blog/blog/october-2019/java13/ title="Java 13 on Ubuntu" class=dd-item><a href=/blog/blog/october-2019/java13/><b>28th. </b>Java 13 on Ubuntu</a></li><li data-nav-id=/blog/blog/october-2019/voronoi/ title="Voronoi Diagram" class=dd-item><a href=/blog/blog/october-2019/voronoi/><b>29th. </b>Voronoi Diagram</a></li></ul></li><li data-nav-id=/blog/blog/november-2019/ title="November 2019" class=dd-item><a href=/blog/blog/november-2019/><b></b>November 2019</a><ul><li data-nav-id=/blog/blog/november-2019/firestore/ title="Nested Data in Documents (FireStore)" class=dd-item><a href=/blog/blog/november-2019/firestore/><b>1st. </b>Nested Data in Documents (FireStore)</a></li><li data-nav-id=/blog/blog/november-2019/singletonobserverpattern/ title="Singleton &amp; Observer Pattern" class=dd-item><a href=/blog/blog/november-2019/singletonobserverpattern/><b>3th. </b>Singleton &amp; Observer Pattern</a></li></ul></li></ul></li><li data-nav-id=/blog/thepragmatic/ title="Pragmatic Programmer" class=dd-item><a href=/blog/thepragmatic/><b></b>Pragmatic Programmer</a><ul><li data-nav-id=/blog/thepragmatic/rubberduck/ title="Rubber Duck" class=dd-item><a href=/blog/thepragmatic/rubberduck/><b>1. </b>Rubber Duck</a></li></ul></li><li data-nav-id=/blog/teaching/ title=Teaching class=dd-item><a href=/blog/teaching/><b></b>Teaching</a><ul><li data-nav-id=/blog/teaching/ubuntu/ title=Ubuntu class=dd-item><a href=/blog/teaching/ubuntu/><b></b>Ubuntu</a><ul><li data-nav-id=/blog/teaching/ubuntu/ls/ title="The File System" class=dd-item><a href=/blog/teaching/ubuntu/ls/><b>1. </b>The File System</a></li></ul></li><li data-nav-id=/blog/teaching/uml/ title=UML class=dd-item><a href=/blog/teaching/uml/><b></b>UML</a><ul><li data-nav-id=/blog/teaching/uml/introduction/ title="What are State Machine Diagrams?" class=dd-item><a href=/blog/teaching/uml/introduction/><b>1. </b>What are State Machine Diagrams?</a></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://jianliew.me/blog/cv><i class="far fa-file fa-fw"></i>Curriculum Vitae</a></li><li><a class=padding href=https://jianliew.me/blog/timeline><i class="fas fa-history fa-fw"></i>Time Line</a></li><li><a class=padding href=https://jianliew.me/blog/tags><i class="fas fa-tags fa-fw"></i>Tags</a></li><li><a class=padding href=https://jianliew.me/blog/disclaimer><i class="fas fa-exclamation-triangle fa-fw"></i>Disclaimer</a></li><li><a class=padding href=https://github.com/JianLoong><i class="fab fa-github fa-fw"></i>GitHub Repo</a></li><li><a class=padding href=https://au.linkedin.com/in/jian-loong-liew-0433ab39><i class="fab fa-linkedin-in fa-fw"></i>Linkedin</a></li><li><a class=padding href=mailto:jianloongliew@gmail.com><i class="fas fa-envelope-square fa-fw"></i>Email</a></li></ul></section><section id=footer><p>Built with <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/blog/>Contents</a> > <a href=/blog/blog/>Blog</a> > <a href=/blog/blog/october-2019/>October 2019</a> > k-Nearest Neighbour on Maps</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><ul><li><ul><li><a href=#lessons-from-this-blog-post>Lessons from this blog post.</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>k-Nearest Neighbour on Maps</h1><p>Posted on: <strong>Sunday, October 27, 2019</strong></p><p>Reading time: <strong>2 minutes and
23 seconds.</strong></p><hr><div class="notices note"><p>One of the most common query when working with maps is the nearest neighbour query. This post will explain how to accomplish an easy nearest neighbour query.</p></div><p>We will first start with a data set or coordinates.</p><p><embed src=https://www.desmos.com/calculator/q0nyt99bcr?embed width=100% height=500px style="border:1px solid #ccc" frameborder=0></embed></p><p>The Nearest Neighbour Query on the map aims to return the nearest neighbour of a point. So, in the example, it can be seen that the 1st Nearest Neighbour of New York would be Boston and the 2nd Nearest Neighbour of New York Would be Chicago. This goes on for the k value. The interesting thing to remember is that <strong>the starting point of the query often times do not start from the set of existing points</strong>.</p><p>What if we would like to query 20 nearest neighbour from a query point? This solution can easily be answered with a <strong>naive</strong> linear query if we do not have an existing data structure. Basically we can just calculate the distance from each point (each city) to our location to determine which ones are the nearest 20 points to us.</p><p>However, in bigger applications where there would be more points (Think 1 million points), data structures like the <strong>R-tree</strong> would play a very important role to perform such queries. At the end of the day, it is important to understand that algorithms operate on data structures.</p><p>The naive solution would be to do something as follows. (Written in JavaScript)</p><div class=highlight style=background:#272822><pre style=line-height:125%><code class=language-js data-lang=js><span></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sortPointsBasedOnDistance</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>(</span><span style=color:#a6e22e>queryPoint</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>points</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
  <span style=color:#a6e22e>points</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>sort</span><span style=color:#f8f8f2>((</span><span style=color:#a6e22e>pointA</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>pointB</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
    <span style=color:#66d9ef>return</span> <span style=color:#f8f8f2>(</span>
      <span style=color:#a6e22e>calculateDistance</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>queryPoint</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>pointA</span><span style=color:#f8f8f2>)</span> <span style=color:#f92672>-</span>
      <span style=color:#a6e22e>calculateDistance</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>queryPoint</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>pointB</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>);</span>
  <span style=color:#f8f8f2>});</span>
<span style=color:#f8f8f2>};</span>

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>calculateDistance</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>(</span><span style=color:#a6e22e>startingPoint</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>endingPoint</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>endingPoint</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>startingPoint</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>x</span><span style=color:#f8f8f2>;</span>
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>endingPoint</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>startingPoint</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>y</span><span style=color:#f8f8f2>;</span>
  <span style=color:#66d9ef>return</span> <span style=color:#f8f8f2>Math.</span><span style=color:#a6e22e>hypot</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>x</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>y</span><span style=color:#f8f8f2>);</span>
<span style=color:#f8f8f2>};</span>

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>createPoint</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>(</span><span style=color:#a6e22e>name</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>x</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>y</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>({</span>
  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>name</span><span style=color:#f8f8f2>,</span>
  <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>x</span><span style=color:#f8f8f2>,</span>
  <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>y</span>
<span style=color:#f8f8f2>});</span>

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>points</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>[];</span>
<span style=color:#a6e22e>points</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>push</span><span style=color:#f8f8f2>(</span>
  <span style=color:#a6e22e>createPoint</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;New York&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>40</span><span style=color:#f8f8f2>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>74</span><span style=color:#f8f8f2>),</span>
  <span style=color:#a6e22e>createPoint</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Chicago&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>41</span><span style=color:#f8f8f2>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>87</span><span style=color:#f8f8f2>),</span>
  <span style=color:#a6e22e>createPoint</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Minneapolis&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>44</span><span style=color:#f8f8f2>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>93</span><span style=color:#f8f8f2>),</span>
  <span style=color:#a6e22e>createPoint</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Boston&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>42</span><span style=color:#f8f8f2>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>71</span><span style=color:#f8f8f2>),</span>
  <span style=color:#a6e22e>createPoint</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Denver&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>39</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>104</span><span style=color:#f8f8f2>),</span>
  <span style=color:#a6e22e>createPoint</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Dallas&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>32</span><span style=color:#f8f8f2>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>96</span><span style=color:#f8f8f2>)</span>
<span style=color:#f8f8f2>);</span>

<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>queryPoint</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createPoint</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;Query Point&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>40</span><span style=color:#f8f8f2>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>74</span><span style=color:#f8f8f2>);</span>

<span style=color:#a6e22e>sortPointsBasedOnDistance</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>queryPoint</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>points</span><span style=color:#f8f8f2>);</span>

<span style=color:#a6e22e>console</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>log</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>points</span><span style=color:#f8f8f2>);</span>
</code></pre></div><h4 id=lessons-from-this-blog-post>Lessons from this blog post.</h4><ul><li>It is hard to explain a year longs&rsquo; research in a single blog post.</li><li>Console.log in JavaScript is passed a reference to the object, thus the value will actually change when the object changes. It is <strong>not</strong> the value of he object at the moment in time where you call console.log.</li><li>There are not many existing libraries written in JavaScript that deals with these specialised queries. (Perhaps more investigation is needed)</li><li>The sort function in JavaScript is an ES6 feature, careful consideration needs to be taken into account when using it and also be careful with the curly bracers and no curly bracers.</li><li>Creating an object requires brackets &ldquo;(&rdquo; wrapped around &ldquo;{&rdquo; parenthesis.</li></ul><script>const sortPointsBasedOnDistance=(queryPoint,points)=>{points.sort((pointA,pointB)=>calculateDistance(queryPoint,pointA)-calculateDistance(queryPoint,pointB))}
const calculateDistance=(startingPoint,endingPoint)=>{let x=endingPoint.x-startingPoint.x;let y=endingPoint.y-startingPoint.y;return Math.hypot(x,y);}
const createPoint=(name,x,y)=>({name:name,x:x,y:y});let points=[];points.push(createPoint("New York",40,-74),createPoint("Chicago",41,-87),createPoint("Minneapolis",44,-93),createPoint("Boston",42,-71),createPoint("Denver",39,104),createPoint("Dallas",32,-96));let queryPoint=createPoint("Query Point",40,-74);sortPointsBasedOnDistance(queryPoint,points);console.log(points);</script><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/blog/blog/october-2019/promiseall/ title="Promise All"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/blog/blog/october-2019/java13/ title="Java 13 on Ubuntu" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/blog/js/clipboard.min.js?1572777884></script><script src=/blog/js/perfect-scrollbar.min.js?1572777884></script><script src=/blog/js/perfect-scrollbar.jquery.min.js?1572777884></script><script src=/blog/js/jquery.sticky.js?1572777884></script><script src=/blog/js/featherlight.min.js?1572777884></script><script src=/blog/js/highlight.pack.js?1572777884></script><script>hljs.initHighlightingOnLoad();</script><script src=/blog/js/modernizr.custom-3.6.0.js?1572777884></script><script src=/blog/js/learn.js?1572777884></script><script src=/blog/js/hugo-learn.js?1572777884></script><link href=/blog/mermaid/mermaid.css?1572777884 rel=stylesheet><script src=/blog/mermaid/mermaid.js?1572777884></script><script>mermaid.initialize({startOnLoad:true,flowchart:{curve:'basis'},classDiagram:{htmlLabels:true}});</script></body></html>