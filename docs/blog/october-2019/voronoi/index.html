<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.59.1"><meta name=description content><link rel=icon href=/blog/images/favicon.ico type=image/ico><title>Voronoi Diagram :: Jian Liew</title><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-55422968-1','auto');ga('send','pageview');}</script><link href=/blog/css/nucleus.css?1572781529 rel=stylesheet><link href=/blog/css/fontawesome-all.min.css?1572781529 rel=stylesheet><link href=/blog/css/hybrid.css?1572781529 rel=stylesheet><link href=/blog/css/featherlight.min.css?1572781529 rel=stylesheet><link href=/blog/css/perfect-scrollbar.min.css?1572781529 rel=stylesheet><link href=/blog/css/auto-complete.css?1572781529 rel=stylesheet><link href=/blog/css/atom-one-dark-reasonable.css?1572781529 rel=stylesheet><link href=/blog/css/theme.css?1572781529 rel=stylesheet><link href=/blog/css/hugo-theme.css?1572781529 rel=stylesheet><link href=/blog/css/theme-blue.css?1572781529 rel=stylesheet><script src=/blog/js/jquery-3.3.1.min.js?1572781529></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/blog/blog/october-2019/voronoi/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://jianliew.me/blog>Jian</a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/blog/js/lunr.min.js?1572781529></script><script type=text/javascript src=/blog/js/auto-complete.js?1572781529></script><script type=text/javascript>var baseurl="https:\/\/jianliew.me\/blog";</script><script type=text/javascript src=/blog/js/search.js?1572781529></script></div><div class=highlightable><ul class=topics><li data-nav-id=/blog/blog/ title=Blog class="dd-item
parent"><a href=/blog/blog/><b></b>Blog</a><ul><li data-nav-id=/blog/blog/october-2019/ title="October 2019" class="dd-item
parent"><a href=/blog/blog/october-2019/><b></b>October 2019</a><ul><li data-nav-id=/blog/blog/october-2019/guard/ title="Explicit Else (Guard)" class=dd-item><a href=/blog/blog/october-2019/guard/><b>1st. </b>Explicit Else (Guard)</a></li><li data-nav-id=/blog/blog/october-2019/percentage/ title="Reddit Chart" class=dd-item><a href=/blog/blog/october-2019/percentage/><b>9th. </b>Reddit Chart</a></li><li data-nav-id=/blog/blog/october-2019/programmming/ title="Reddit Word Cloud" class=dd-item><a href=/blog/blog/october-2019/programmming/><b>12th. </b>Reddit Word Cloud</a></li><li data-nav-id=/blog/blog/october-2019/hk/ title="Sentiment Analysis" class=dd-item><a href=/blog/blog/october-2019/hk/><b>13th. </b>Sentiment Analysis</a></li><li data-nav-id=/blog/blog/october-2019/topstories/ title="Hacker News Word Cloud" class=dd-item><a href=/blog/blog/october-2019/topstories/><b>14th. </b>Hacker News Word Cloud</a></li><li data-nav-id=/blog/blog/october-2019/ga/ title="Genetic Algorithm" class=dd-item><a href=/blog/blog/october-2019/ga/><b>19th. </b>Genetic Algorithm</a></li><li data-nav-id=/blog/blog/october-2019/tsp/ title="TSP using GA" class=dd-item><a href=/blog/blog/october-2019/tsp/><b>23th. </b>TSP using GA</a></li><li data-nav-id=/blog/blog/october-2019/promiseall/ title="Promise All" class=dd-item><a href=/blog/blog/october-2019/promiseall/><b>25th. </b>Promise All</a></li><li data-nav-id=/blog/blog/october-2019/nearestneighbour/ title="k-Nearest Neighbour on Maps" class=dd-item><a href=/blog/blog/october-2019/nearestneighbour/><b>27th. </b>k-Nearest Neighbour on Maps</a></li><li data-nav-id=/blog/blog/october-2019/java13/ title="Java 13 on Ubuntu" class=dd-item><a href=/blog/blog/october-2019/java13/><b>28th. </b>Java 13 on Ubuntu</a></li><li data-nav-id=/blog/blog/october-2019/voronoi/ title="Voronoi Diagram" class="dd-item active"><a href=/blog/blog/october-2019/voronoi/><b>29th. </b>Voronoi Diagram</a></li></ul></li><li data-nav-id=/blog/blog/november-2019/ title="November 2019" class=dd-item><a href=/blog/blog/november-2019/><b></b>November 2019</a><ul><li data-nav-id=/blog/blog/november-2019/firestore/ title="Nested Data in Documents (FireStore)" class=dd-item><a href=/blog/blog/november-2019/firestore/><b>1st. </b>Nested Data in Documents (FireStore)</a></li><li data-nav-id=/blog/blog/november-2019/singletonobserverpattern/ title="Singleton &amp; Observer Pattern (Java)" class=dd-item><a href=/blog/blog/november-2019/singletonobserverpattern/><b>3th. </b>Singleton &amp; Observer Pattern (Java)</a></li></ul></li></ul></li><li data-nav-id=/blog/thepragmatic/ title="Pragmatic Programmer" class=dd-item><a href=/blog/thepragmatic/><b></b>Pragmatic Programmer</a><ul><li data-nav-id=/blog/thepragmatic/rubberduck/ title="Rubber Duck" class=dd-item><a href=/blog/thepragmatic/rubberduck/><b>1. </b>Rubber Duck</a></li></ul></li><li data-nav-id=/blog/teaching/ title=Teaching class=dd-item><a href=/blog/teaching/><b></b>Teaching</a><ul><li data-nav-id=/blog/teaching/ubuntu/ title=Ubuntu class=dd-item><a href=/blog/teaching/ubuntu/><b></b>Ubuntu</a><ul><li data-nav-id=/blog/teaching/ubuntu/ls/ title="The File System" class=dd-item><a href=/blog/teaching/ubuntu/ls/><b>1. </b>The File System</a></li></ul></li><li data-nav-id=/blog/teaching/uml/ title=UML class=dd-item><a href=/blog/teaching/uml/><b></b>UML</a><ul><li data-nav-id=/blog/teaching/uml/introduction/ title="What are State Machine Diagrams?" class=dd-item><a href=/blog/teaching/uml/introduction/><b>1. </b>What are State Machine Diagrams?</a></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://jianliew.me/blog/cv><i class="far fa-file fa-fw"></i>Curriculum Vitae</a></li><li><a class=padding href=https://jianliew.me/blog/timeline><i class="fas fa-history fa-fw"></i>Time Line</a></li><li><a class=padding href=https://jianliew.me/blog/tags><i class="fas fa-tags fa-fw"></i>Tags</a></li><li><a class=padding href=https://jianliew.me/blog/disclaimer><i class="fas fa-exclamation-triangle fa-fw"></i>Disclaimer</a></li><li><a class=padding href=https://github.com/JianLoong><i class="fab fa-github fa-fw"></i>GitHub Repo</a></li><li><a class=padding href=https://au.linkedin.com/in/jian-loong-liew-0433ab39><i class="fab fa-linkedin-in fa-fw"></i>Linkedin</a></li><li><a class=padding href=mailto:jianloongliew@gmail.com><i class="fas fa-envelope-square fa-fw"></i>Email</a></li></ul></section><section id=footer><p>Built with <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/blog/>Contents</a> > <a href=/blog/blog/>Blog</a> > <a href=/blog/blog/october-2019/>October 2019</a> > Voronoi Diagram</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><ul><li><ul><li><a href=#example-of-a-query>Example of a query</a><ul><li><a href=#the-codes-to-create-this-diagram-are-as-follows>The codes to create this diagram are as follows</a></li></ul></li><li><a href=#lessons-from-this-blog-post>Lessons from this blog post.</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/blog/tags/nearest-neighbour>Nearest Neighbour</a>
<a class=tag-link href=/blog/tags/maps>Maps</a>
<a class=tag-link href=/blog/tags/voronoi>Voronoi</a></div></div><div id=body-inner><h1>Voronoi Diagram</h1><p>Posted on: <strong>Sunday, October 13, 2019</strong></p><p>Reading time: <strong>5 minutes and
7 seconds.</strong></p><hr><script src=https://unpkg.com/d3@5.12.0/dist/d3.min.js></script><script src=/blog/scripts/d3-delaunay.min.js></script><div class="notices note"><p>One of the most common query when working with maps is the nearest neighbour query. This blog post will use Voronoi Diagrams to explain more regarding the nearest neighbour query.</p></div><p>Below is an example of a Voronoi diagram generated using d3.js. One of the good use case of a voronoi diagram in real life applications would be where would be <strong>finding a place to build emergency services.</strong> This place should have the most number of neighbouring regions. For example, if you <code>click</code> on the region in the voronoi diagram below, you can see how many regions in which it would consider this region to be its neighbour. The diagram is randomly generated based on a number of points and thus every refresh of this page will show a different voronoi diagram.</p><div id=canvas style=text-align:center;max-width:30em;margin:auto></div><p align=center><strong>Fig 1. Voronoi Diagram generated with 30 random points</strong></p><p>The codes to create this diagram are as follows :-</p><div class=highlight style=background:#272822><pre style=line-height:125%><code class=language-javascript data-lang=javascript><span></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>createVoronoi</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>()</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>600</span><span style=color:#f8f8f2>;</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>600</span><span style=color:#f8f8f2>;</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>vertices</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>range</span><span style=color:#f8f8f2>(</span><span style=color:#ae81ff>30</span><span style=color:#f8f8f2>).</span><span style=color:#a6e22e>map</span><span style=color:#f8f8f2>(</span><span style=color:#66d9ef>function</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>d</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>{</span>
    <span style=color:#66d9ef>return</span> <span style=color:#f8f8f2>[Math.</span><span style=color:#a6e22e>random</span><span style=color:#f8f8f2>()</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>width</span><span style=color:#f8f8f2>,</span> <span style=color:#f8f8f2>Math.</span><span style=color:#a6e22e>random</span><span style=color:#f8f8f2>()</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>height</span><span style=color:#f8f8f2>];</span>
  <span style=color:#f8f8f2>});</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>delaunay</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>Delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>from</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>vertices</span><span style=color:#f8f8f2>);</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>voronoi</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>([</span><span style=color:#ae81ff>0</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>0</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>width</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>height</span><span style=color:#f8f8f2>]);</span>
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>svg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>select</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;#canvas&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;svg&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;viewBox&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>`0 0 600 600`</span><span style=color:#f8f8f2>);</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mesh</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>svg</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;path&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;fill&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;none&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;#ccc&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke-width&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>1</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;d&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>render</span><span style=color:#f8f8f2>());</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bounds</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>svg</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;path&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;fill&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;none&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;#ccc&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke-width&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>1</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;d&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>renderBounds</span><span style=color:#f8f8f2>());</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>points</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>svg</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;path&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;fill&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;black&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;#ccc&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke-width&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>1</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;d&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>renderPoints</span><span style=color:#f8f8f2>());</span>
<span style=color:#f8f8f2>};</span>
</code></pre></div><h4 id=example-of-a-query>Example of a query</h4><p>I will now re-use my data set of point from an earlier blog entry and I will generate the voronoi diagram. Basically, I would use a query point as well to find out the nearest neighbour and the surrounding neighbours. The figure below shows that the d3-delaunay provides a simple functions that allows you to find the point in which is the closest to the query point. This is done by using <code>delaunay.find()</code>. So if you are <strong>inside the blue region</strong>, your closest point would be the point inside the blue region.</p><p>It&rsquo;s surrounding neighbours could then be easily obtained once you have this point by using <code>delaunay.neighbor()</code> and passing the result of the first find function. So, the regions which are in teal would be the <strong>neighbours of the region in blue</strong>. All the other regions would be coloured in green. This simple data structure would allow you to easily obtain the nearest neighbour. However, of course, there is also the importance of the build time, insertion time and removal time as well.</p><p><div id=exampleQuery style=text-align:center;max-width:30em;margin:auto></div><p align=center><strong>Fig 2. Voronoi Diagram for a NN query.</strong></p></p><h5 id=the-codes-to-create-this-diagram-are-as-follows>The codes to create this diagram are as follows</h5><div class=highlight style=background:#272822><pre style=line-height:125%><code class=language-javascript data-lang=javascript><span></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>queryExample</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>()</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>points</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>[</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>40</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>74</span><span style=color:#f8f8f2>],</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>34</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>118</span><span style=color:#f8f8f2>],</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>41</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>87</span><span style=color:#f8f8f2>],</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>44</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>93</span><span style=color:#f8f8f2>],</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>39</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>104</span><span style=color:#f8f8f2>],</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>32</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>96</span><span style=color:#f8f8f2>],</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>47</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>122</span><span style=color:#f8f8f2>],</span>
    <span style=color:#f8f8f2>[</span><span style=color:#ae81ff>42</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>71</span><span style=color:#f8f8f2>]</span>
  <span style=color:#f8f8f2>];</span>

  <span style=color:#75715e>// Function to transform the points so that it would work on the grid</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>transform</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>point</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
    <span style=color:#66d9ef>return</span> <span style=color:#f8f8f2>[(</span><span style=color:#a6e22e>point</span><span style=color:#f8f8f2>[</span><span style=color:#ae81ff>0</span><span style=color:#f8f8f2>]</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>90</span><span style=color:#f8f8f2>)</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>500</span><span style=color:#f8f8f2>,</span> <span style=color:#f8f8f2>(</span><span style=color:#a6e22e>point</span><span style=color:#f8f8f2>[</span><span style=color:#ae81ff>1</span><span style=color:#f8f8f2>]</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>180</span><span style=color:#f8f8f2>)</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>500</span><span style=color:#f8f8f2>];</span>
  <span style=color:#f8f8f2>};</span>

  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>transformed</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>[];</span>

  <span style=color:#a6e22e>points</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>forEach</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>element</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
    <span style=color:#a6e22e>transformed</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>push</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>transform</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>element</span><span style=color:#f8f8f2>));</span>
  <span style=color:#f8f8f2>});</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>delaunay</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>Delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>from</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>points</span><span style=color:#f8f8f2>);</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>voronoi</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>([</span><span style=color:#ae81ff>0</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>0</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>500</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>500</span><span style=color:#f8f8f2>]);</span>

  <span style=color:#75715e>// Call the draw Voronoi function.</span>
  <span style=color:#a6e22e>drawVoronoi</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;#exampleQuery&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>transformed</span><span style=color:#f8f8f2>);</span>
<span style=color:#f8f8f2>};</span>

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>drawVoronoi</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>(</span><span style=color:#a6e22e>id</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>vertices</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>color</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>500</span><span style=color:#f8f8f2>,</span>
    <span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>500</span><span style=color:#f8f8f2>;</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>delaunay</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>Delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>from</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>vertices</span><span style=color:#f8f8f2>);</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>voronoi</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>([</span><span style=color:#ae81ff>0</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>0</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>width</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>height</span><span style=color:#f8f8f2>]);</span>
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>svg</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>d3</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>select</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>id</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;svg&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;viewBox&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>`0 0 500 500`</span><span style=color:#f8f8f2>);</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mesh</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>svg</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;path&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;fill&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;none&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;#ccc&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke-width&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>1</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;d&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>render</span><span style=color:#f8f8f2>());</span>

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bounds</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>svg</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;path&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;fill&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;none&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;#ccc&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke-width&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>1</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;d&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>renderBounds</span><span style=color:#f8f8f2>());</span>

  <span style=color:#75715e>// Find the closest point to this coordinate.</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ans</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>find</span><span style=color:#f8f8f2>(</span><span style=color:#ae81ff>40</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>73</span><span style=color:#f8f8f2>);</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>neighbours</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>neighbors</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>ans</span><span style=color:#f8f8f2>);</span>
  <span style=color:#66d9ef>for</span> <span style=color:#f8f8f2>(</span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>iterator</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>neighbours</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>{</span>
    <span style=color:#a6e22e>renderCell</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>svg</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>iterator</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>d3</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>schemeTableau10</span><span style=color:#f8f8f2>[</span><span style=color:#ae81ff>3</span><span style=color:#f8f8f2>]);</span>
  <span style=color:#f8f8f2>}</span>

  <span style=color:#a6e22e>renderCell</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>svg</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>ans</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>d3</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>schemeTableau10</span><span style=color:#f8f8f2>[</span><span style=color:#ae81ff>0</span><span style=color:#f8f8f2>]);</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>points</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>svg</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;path&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;fill&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;black&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;#ccc&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke-width&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>1</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;d&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>delaunay</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>renderPoints</span><span style=color:#f8f8f2>());</span>
<span style=color:#f8f8f2>};</span>

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>renderCell</span> <span style=color:#f92672>=</span> <span style=color:#f8f8f2>(</span><span style=color:#a6e22e>svg</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>index</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>color</span><span style=color:#f8f8f2>)</span> <span style=color:#f8f8f2>=&gt;</span> <span style=color:#f8f8f2>{</span>
  <span style=color:#a6e22e>svg</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>append</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;path&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;fill&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>color</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#e6db74>&quot;#ccc&quot;</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;stroke-width&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#ae81ff>1</span><span style=color:#f8f8f2>)</span>
    <span style=color:#f8f8f2>.</span><span style=color:#a6e22e>attr</span><span style=color:#f8f8f2>(</span><span style=color:#e6db74>&quot;d&quot;</span><span style=color:#f8f8f2>,</span> <span style=color:#a6e22e>voronoi</span><span style=color:#f8f8f2>.</span><span style=color:#a6e22e>renderCell</span><span style=color:#f8f8f2>(</span><span style=color:#a6e22e>index</span><span style=color:#f8f8f2>));</span>
<span style=color:#f8f8f2>};</span>
</code></pre></div><h4 id=lessons-from-this-blog-post>Lessons from this blog post.</h4><ul><li>The learning curve for d3.js is <strong>pretty insane.</strong></li><li>Voronois are pretty easy using d3.</li><li>Generators can be iterated using the for&hellip;of construct. <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators>MDN link</a></li><li>There is a way to make SVG responsive. Refer <a href=https://medium.com/@louisemoxy/a-simple-way-to-make-d3-js-charts-svgs-responsive-7afb04bc2e4b>this</a> post.</li></ul><script>const queryExample=()=>{let points=[[40,74],[34,118],[41,87],[44,93],[39,104],[32,96],[47,122],[42,71]];const transform=point=>{return[point[0]/90*500,point[1]/180*500];}
let transformed=[];points.forEach(element=>{transformed.push(transform(element));});const delaunay=d3.Delaunay.from(points);const voronoi=delaunay.voronoi([0,0,500,500]);drawVoronoi("#exampleQuery",transformed);}
const renderCell=(svg,voronoi,index,color)=>{svg.append("path").attr("fill",color).attr("stroke","#ccc").attr("stroke-width",1).attr("d",voronoi.renderCell(index));}
const drawVoronoi=(id,vertices,color)=>{const width=500,height=500;const delaunay=d3.Delaunay.from(vertices);const voronoi=delaunay.voronoi([0,0,500,500]);let svg=d3.select(id).append("svg").attr("viewBox",`0 0 500 500`);const mesh=svg.append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",1).attr("d",voronoi.render());const bounds=svg.append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",1).attr("d",voronoi.renderBounds());const ans=delaunay.find(40,73);for(let index=0;index<vertices.length;index++){const element=vertices[index];renderCell(svg,voronoi,index,d3.schemeTableau10[4]);}
const neighbours=delaunay.neighbors(ans);for(const iterator of neighbours){renderCell(svg,voronoi,iterator,d3.schemeTableau10[3]);};renderCell(svg,voronoi,ans,d3.schemeTableau10[0]);const points=svg.append("path").attr("fill","black").attr("stroke","#ccc").attr("stroke-width",1).attr("d",delaunay.renderPoints());};const drawExampleVoronoi=()=>{const width=600,height=600;const radius=10;const circles=d3.range(30).map(i=>({x:Math.random()*(width-radius*2)+radius,y:Math.random()*(height-radius*2)+radius,}));const delaunay=d3.Delaunay.from(circles,d=>d.x,d=>d.y);const voronoi=delaunay.voronoi([0,0,width,height]);let svg=d3.select("#canvas").append("svg").attr("viewBox",`0 0 600 600`);const mesh=svg.append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",1).attr("d",voronoi.render());const bounds=svg.append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",1).attr("d",voronoi.renderBounds());const points=svg.append("path").attr("fill","black").attr("stroke","#ccc").attr("stroke-width",1).attr("d",delaunay.renderPoints());};const drawVoronoiWithPoints=(id,noOfPoints)=>{let selected=undefined;const width=1000,height=1000;const circles=d3.range(30).map(function(d){return[Math.random()*width,Math.random()*height];});const query=[Math.random()*width,Math.random()*height];const delaunay=d3.Delaunay.from(circles);const voronoi=delaunay.voronoi([0,0,width,height]);let svg=d3.select(id).append("svg").attr("viewBox",`0 0 1000 1000`);const mesh=svg.append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",5).attr("d",voronoi.render());const bounds=svg.append("path").attr("fill","none").attr("stroke","#ccc").attr("stroke-width",5).attr("d",voronoi.renderBounds());const points=()=>svg.append("path").attr("fill","black").attr("stroke","#ccc").attr("stroke-width",2).attr("d",delaunay.renderPoints());points();svg.on("click",function(){var coords=d3.mouse(this);if(selected!=undefined){renderCell(svg,voronoi,selected,"white");for(const iterator of delaunay.neighbors(selected))
renderCell(svg,voronoi,iterator,"white");selected=undefined;}
const ans=(delaunay.find(coords[0],coords[1]));selected=ans;renderCell(svg,voronoi,ans,d3.schemeTableau10[0]);points();const neighbours=delaunay.neighbors(ans);for(const iterator of neighbours){renderCell(svg,voronoi,iterator,d3.schemeTableau10[3]);};});};queryExample();drawVoronoiWithPoints("#canvas",30);</script><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/blog/blog/october-2019/java13/ title="Java 13 on Ubuntu"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/blog/blog/november-2019/ title="November 2019" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/blog/js/clipboard.min.js?1572781530></script><script src=/blog/js/perfect-scrollbar.min.js?1572781530></script><script src=/blog/js/perfect-scrollbar.jquery.min.js?1572781530></script><script src=/blog/js/jquery.sticky.js?1572781530></script><script src=/blog/js/featherlight.min.js?1572781530></script><script src=/blog/js/highlight.pack.js?1572781530></script><script>hljs.initHighlightingOnLoad();</script><script src=/blog/js/modernizr.custom-3.6.0.js?1572781530></script><script src=/blog/js/learn.js?1572781530></script><script src=/blog/js/hugo-learn.js?1572781530></script><link href=/blog/mermaid/mermaid.css?1572781530 rel=stylesheet><script src=/blog/mermaid/mermaid.js?1572781530></script><script>mermaid.initialize({startOnLoad:true,flowchart:{curve:'basis'},classDiagram:{htmlLabels:true}});</script></body></html>