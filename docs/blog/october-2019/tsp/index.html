<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.59.1"><meta name=description content><link rel=icon href=/blog/images/favicon.ico type=image/ico><title>TSP using GA :: Jian Liew</title><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-55422968-1','auto');ga('send','pageview');}</script><link href=/blog/css/nucleus.css?1572862398 rel=stylesheet><link href=/blog/css/fontawesome-all.min.css?1572862398 rel=stylesheet><link href=/blog/css/hybrid.css?1572862398 rel=stylesheet><link href=/blog/css/featherlight.min.css?1572862398 rel=stylesheet><link href=/blog/css/perfect-scrollbar.min.css?1572862398 rel=stylesheet><link href=/blog/css/auto-complete.css?1572862398 rel=stylesheet><link href=/blog/css/atom-one-dark-reasonable.css?1572862398 rel=stylesheet><link href=/blog/css/theme.css?1572862398 rel=stylesheet><link href=/blog/css/hugo-theme.css?1572862398 rel=stylesheet><link href=/blog/css/theme-blue.css?1572862398 rel=stylesheet><script src=/blog/js/jquery-3.3.1.min.js?1572862398></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/blog/blog/october-2019/tsp/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=https://jianliew.me/blog>Jian</a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/blog/js/lunr.min.js?1572862398></script><script type=text/javascript src=/blog/js/auto-complete.js?1572862398></script><script type=text/javascript>var baseurl="https:\/\/jianliew.me\/blog";</script><script type=text/javascript src=/blog/js/search.js?1572862398></script></div><div class=highlightable><ul class=topics><li data-nav-id=/blog/blog/ title=Blog class="dd-item
parent"><a href=/blog/blog/><b></b>Blog</a><ul><li data-nav-id=/blog/blog/november-2019/ title="November 2019" class=dd-item><a href=/blog/blog/november-2019/><b></b>November 2019</a><ul><li data-nav-id=/blog/blog/november-2019/firestore/ title="Nested Data in Documents (FireStore)" class=dd-item><a href=/blog/blog/november-2019/firestore/><b>1st. </b>Nested Data in Documents (FireStore)</a></li><li data-nav-id=/blog/blog/november-2019/singletonobserverpattern/ title="Singleton &amp; Observer Pattern (Java)" class=dd-item><a href=/blog/blog/november-2019/singletonobserverpattern/><b>3th. </b>Singleton &amp; Observer Pattern (Java)</a></li><li data-nav-id=/blog/blog/november-2019/javascriptsort/ title="JavaScript Sort Stability" class=dd-item><a href=/blog/blog/november-2019/javascriptsort/><b>4th. </b>JavaScript Sort Stability</a></li></ul></li><li data-nav-id=/blog/blog/october-2019/ title="October 2019" class="dd-item
parent"><a href=/blog/blog/october-2019/><b></b>October 2019</a><ul><li data-nav-id=/blog/blog/october-2019/guard/ title="Explicit Else (Guard)" class=dd-item><a href=/blog/blog/october-2019/guard/><b>1st. </b>Explicit Else (Guard)</a></li><li data-nav-id=/blog/blog/october-2019/percentage/ title="Reddit Chart" class=dd-item><a href=/blog/blog/october-2019/percentage/><b>9th. </b>Reddit Chart</a></li><li data-nav-id=/blog/blog/october-2019/programmming/ title="Reddit Word Cloud" class=dd-item><a href=/blog/blog/october-2019/programmming/><b>12th. </b>Reddit Word Cloud</a></li><li data-nav-id=/blog/blog/october-2019/hk/ title="Sentiment Analysis" class=dd-item><a href=/blog/blog/october-2019/hk/><b>13th. </b>Sentiment Analysis</a></li><li data-nav-id=/blog/blog/october-2019/topstories/ title="Hacker News Word Cloud" class=dd-item><a href=/blog/blog/october-2019/topstories/><b>14th. </b>Hacker News Word Cloud</a></li><li data-nav-id=/blog/blog/october-2019/ga/ title="Genetic Algorithm" class=dd-item><a href=/blog/blog/october-2019/ga/><b>19th. </b>Genetic Algorithm</a></li><li data-nav-id=/blog/blog/october-2019/tsp/ title="TSP using GA" class="dd-item active"><a href=/blog/blog/october-2019/tsp/><b>23th. </b>TSP using GA</a></li><li data-nav-id=/blog/blog/october-2019/promiseall/ title="Promise All" class=dd-item><a href=/blog/blog/october-2019/promiseall/><b>25th. </b>Promise All</a></li><li data-nav-id=/blog/blog/october-2019/nearestneighbour/ title="k-Nearest Neighbour on Maps" class=dd-item><a href=/blog/blog/october-2019/nearestneighbour/><b>27th. </b>k-Nearest Neighbour on Maps</a></li><li data-nav-id=/blog/blog/october-2019/java13/ title="Java 13 on Ubuntu" class=dd-item><a href=/blog/blog/october-2019/java13/><b>28th. </b>Java 13 on Ubuntu</a></li><li data-nav-id=/blog/blog/october-2019/voronoi/ title="Voronoi Diagram" class=dd-item><a href=/blog/blog/october-2019/voronoi/><b>29th. </b>Voronoi Diagram</a></li></ul></li></ul></li><li data-nav-id=/blog/thepragmatic/ title="Pragmatic Programmer" class=dd-item><a href=/blog/thepragmatic/><b></b>Pragmatic Programmer</a><ul><li data-nav-id=/blog/thepragmatic/rubberduck/ title="Rubber Duck" class=dd-item><a href=/blog/thepragmatic/rubberduck/><b>1. </b>Rubber Duck</a></li></ul></li><li data-nav-id=/blog/teaching/ title=Teaching class=dd-item><a href=/blog/teaching/><b></b>Teaching</a><ul><li data-nav-id=/blog/teaching/ubuntu/ title=Ubuntu class=dd-item><a href=/blog/teaching/ubuntu/><b></b>Ubuntu</a><ul><li data-nav-id=/blog/teaching/ubuntu/ls/ title="The File System" class=dd-item><a href=/blog/teaching/ubuntu/ls/><b>1. </b>The File System</a></li></ul></li><li data-nav-id=/blog/teaching/uml/ title=UML class=dd-item><a href=/blog/teaching/uml/><b></b>UML</a><ul><li data-nav-id=/blog/teaching/uml/introduction/ title="What are State Machine Diagrams?" class=dd-item><a href=/blog/teaching/uml/introduction/><b>1. </b>What are State Machine Diagrams?</a></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://jianliew.me/blog/cv><i class="far fa-file fa-fw"></i>Curriculum Vitae</a></li><li><a class=padding href=https://jianliew.me/blog/timeline><i class="fas fa-history fa-fw"></i>Time Line</a></li><li><a class=padding href=https://jianliew.me/blog/tags><i class="fas fa-tags fa-fw"></i>Tags</a></li><li><a class=padding href=https://jianliew.me/blog/disclaimer><i class="fas fa-exclamation-triangle fa-fw"></i>Disclaimer</a></li><li><a class=padding href=https://github.com/JianLoong><i class="fab fa-github fa-fw"></i>GitHub Repo</a></li><li><a class=padding href=https://au.linkedin.com/in/jian-loong-liew-0433ab39><i class="fab fa-linkedin-in fa-fw"></i>Linkedin</a></li><li><a class=padding href=mailto:jianloongliew@gmail.com><i class="fas fa-envelope-square fa-fw"></i>Email</a></li></ul></section><section id=footer><p>Built with <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/blog/>Contents</a> > <a href=/blog/blog/>Blog</a> > <a href=/blog/blog/october-2019/>October 2019</a> > TSP using GA</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#travelling-salesman-problem-using-genetic-algorithm>Travelling Salesman Problem using Genetic Algorithm</a></li><li><a href=#the-genetic-algorithm-solution>The Genetic Algorithm Solution</a><ul><li><a href=#lessons-from-this-post>Lessons from this post</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags><div class=tags><a class=tag-link href=/blog/tags/genetic-algorithm>Genetic Algorithm</a>
<a class=tag-link href=/blog/tags/selection>Selection</a>
<a class=tag-link href=/blog/tags/cross-over>Cross Over</a>
<a class=tag-link href=/blog/tags/tsp>TSP</a></div></div><div id=body-inner><h1>TSP using GA</h1><p>Posted on: <strong>Wednesday, October 23, 2019</strong></p><p>Reading time: <strong>6 minutes and
11 seconds.</strong></p><hr><p><link rel=stylesheet href=//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css><script src=//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js></script><script src=https://cdn.jsdelivr.net/npm/chartist-plugin-pointlabels@0.0.6/dist/chartist-plugin-pointlabels.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/chartist-plugin-legend/0.6.2/chartist-plugin-legend.min.js></script></p><div class="notices note"><p>This post uses GA to generate a high quality solution of the Travelling Salesman Problem.</p></div><div id=cities class=ct-perfect-fourth></div><h3 id=travelling-salesman-problem-using-genetic-algorithm>Travelling Salesman Problem using Genetic Algorithm</h3><p>This blog post is regarding using genetic algorithm to solve the Travelling Salesman Problem. In a one liner the TSP asks the following question: <strong><em>Given a list of cities and the distances between each pair of the cities, what is the shortest possible route that visits each city and returns to the origin city?&rdquo;</em></strong></p><p>The conditions in this scenario are that <strong>no point can be visited twice and it must return to the starting point.</strong> The selected starting point here is New York. (The starting point does not really matter in this scenario.). There are times however, that a point maybe the revisited more than once in order to achieve a better solution. The number of cities in this scenario is 13. In this specific implementation, it will never visit the same city twice.</p><p>The inspiration for this post is based on the google OR-Tools found <a href=https://developers.google.com/optimization/routing/tsp>here</a>. This blog post, however uses Genetic Algorithm to obtain the answer. It is implemented with a <strong>web worker</strong> which runs in the browser based on <strong>JavaScript</strong>.</p><p>I will also reuse the genetic algorithm implementation written for another blog post however with different fitness functions and different cross-over methodologies.</p><table><thead><tr><th>Location</th><th>Coordinates</th><th>Shorthand</th></tr></thead><tbody><tr><td>New York</td><td>40, -74</td><td>A</td></tr><tr><td>Los Angeles</td><td>34, -118</td><td>B</td></tr><tr><td>Chicago</td><td>41, -87</td><td>C</td></tr><tr><td>Minneapolis</td><td>44, -93</td><td>D</td></tr><tr><td>Denver</td><td>39, -104</td><td>E</td></tr><tr><td>Dallas</td><td>32,-96</td><td>F</td></tr><tr><td>Seattle</td><td>47,-122</td><td>G</td></tr><tr><td>Boston</td><td>42,-71</td><td>H</td></tr><tr><td>San Francisco</td><td>37,-122</td><td>I</td></tr><tr><td>St. Louis</td><td>38,-90</td><td>J</td></tr><tr><td>Houston</td><td>29,-95</td><td>K</td></tr><tr><td>Phoenix</td><td>33,-111</td><td>L</td></tr><tr><td>Salt Lake City</td><td>40,-111</td><td>M</td></tr></tbody></table><p><strong>Total number of cities - 13.</strong></p><p>In order to the Genetic Algorithm to work, a distance matrix needs to be given to it. This distance matrix is based on the &ldquo;Euclidean Distance&rdquo; and not Road Network distance. The distance matrix is obtained from <a href=https://developers.google.com/optimization/routing/tsp>here</a> which has 13 cities in the United States.</p><h3 id=the-genetic-algorithm-solution>The Genetic Algorithm Solution</h3><div class=row><div class=columnOne><div><label for=crossOver>Cross Over Method</label>
<select id=crossOverMethod class=select-css>
<option value=ordered>Ordered</option>
<option value=pmx>PMX</option></select></div><div><label for=selection>Selection Method</label>
<select id=selectionMethod class=select-css>
<option value=tournament>Tournament</option>
<option value=random>Random</option>
<option value=rank>Rank</option>
<option value=rouletteWheel>Roulette Wheel</option></select></div><strong>Please click run to see the results based on different cross over and selection methods.</strong><p></p><button type=button id=run class=hvr-sweep-to-right>Run</button><p>It can be observed that the selection method random tends to not give a good result as it would defeat the purpose of the GA algorithm. The current mutation rate of the GA is set to 0.2 for this purpose. The starting population size is set to 20.<p><p>Due to the nature of GA, each run under the given settings will give a different solution as I have defaulted the number of generations to 500. This includes running with the same cross over methodology and selection methodology.</p></div><div><div class=columnTwo><h3 style=text-align:center id=chart-title></h3><div class="ct-chart ct-perfect-fourth"></div></div></div></div><div class=row><div class=columnOne><div><p>The fitness in general would depend on the cross over methodology. For example, if the roulette wheel methodology is used, it can be observed that the average fitness tends to spike more.<p><p>The suggested answer based on the Google OR tools is</p><p><strong>New York -> Boston -> Chicago -> Minneapolis -> Denver -> Salt Lake City ->
Seattle -> San Francisco -> Los Angeles -> Phoenix -> Houston -> Dallas -> St Louis -> New York</strong> which gives the total distance of 7293 miles which is also the minimal tour length.</p><p>The GA however does not obtain this solution. It does however, generate a high quality solution really quick.</p></div></div><div><div class=columnTwo><h5 style=text-align:center id=summary-chart></h5><div class="summary-chart ct-perfect-fourth"></div></div></div></div><h4 id=lessons-from-this-post>Lessons from this post</h4><ul><li><p>The earth is not flat! Mapping putting coordinates using latitude and longitude on a chart, it would work in a different way so it displays beautifully. Latitude and longitude needs to be swapped.</p></li><li><p>Most chart API do not let you specify both the <strong><em>x-axis</em></strong> and <strong><em>y-axis</em></strong> at the same time. This is especially true if the chart is able to generate SVG diagrams. SVG diagrams are always nicer and would generally be of more responsive nature at the end of the day.</p></li><li><p>You can use a series graph to draw lines from a point to point in the chartist API. However, chartist API does not like the situation where there are two values on the same axis. (So it is not able to draw a straight line on the x-axis because of the nature of a series chart. An example of this is where there is a point on 30,55 and 30,65.</p></li><li><p>There are specific data sets in which people benchmark their TSP solutions.</p></li><li><p>The GA will downgrade into a random search if the mutation rate is too high. However, the mutation rate can always be change to tailor to the specific use case.</p></li></ul><script>var defaultOptions={currency:undefined,tooltipFnc:undefined,transformTooltipTextFnc:undefined,class:undefined,anchorToPoint:false,appendToBody:false};let RAD2DEG=180/Math.PI;let PI_4=Math.PI/4;function y2lat(y){return(Math.atan(Math.exp(y/RAD2DEG))/PI_4-1)*90;}
function x2lon(x){return x;}
function lat2y(lat){return lat}
function lon2y(lon){return lon;}
new Chartist.Line(".ct-chart",[],{showLine:true,axisX:{type:Chartist.AutoScaleAxis,onlyInteger:true}});new Chartist.Line(".summary-chart",[],{showLine:true,axisX:{type:Chartist.AutoScaleAxis,onlyInteger:true}});const mapLocation=(x,y)=>{return{x:y,y:x};};const locationA=mapLocation(lat2y(40),lon2y(-74));const locationB=mapLocation(lat2y(34),lon2y(-118));const locationC=mapLocation(lat2y(41),lon2y(-87));const locationD=mapLocation(lat2y(44),lon2y(-93));const locationE=mapLocation(lat2y(39),lon2y(-104));const locationF=mapLocation(lat2y(32),lon2y(-96));const locationG=mapLocation(lat2y(47),lon2y(-122.33));const locationH=mapLocation(lat2y(42),lon2y(-71));const locationI=mapLocation(lat2y(37),lon2y(-122.41));const locationJ=mapLocation(lat2y(38),lon2y(-90));const locationK=mapLocation(lat2y(29),lon2y(-95));const locationL=mapLocation(lat2y(33),lon2y(-111.07));const locationM=mapLocation(lat2y(40),lon2y(-111.89));const buildSeries=result=>{let arrayResult=[];let array=result.split("");for(let index=1;index<array.length;index++){const element=array[index];let inner=[];inner.push(determineLocation(array[index]));inner.push(determineLocation(array[index-1]));inner.sort((a,b)=>a.x-b.x);arrayResult.push(inner);}
return arrayResult;};const determineLocation=character=>{let location=undefined;switch(character){case "A":return locationA;case "B":return locationB;case "C":return locationC;case "D":return locationD;case "E":return locationE;case "F":return locationF;case "G":return locationG;case "H":return locationH;case "I":return locationI;case "J":return locationJ;case "K":return locationK;case "L":return locationL;case "M":return locationM;}};const button=document.getElementById("run");const cm=document.getElementById("crossOverMethod");const sm=document.getElementById("selectionMethod");const title=document.getElementById("chart-title");const summary=document.getElementById("summary-chart");const answerBuilder={labels:[],series:buildSeries("AHCDEMGIBLKFJA")};var defaultOptions={labelClass:'ct-label',labelOffset:{x:0,y:-10},textAnchor:'middle',labelInterpolationFnc:Chartist.noop};var chart=new Chartist.Line("#cities",answerBuilder,{showLine:true,axisX:{type:Chartist.AutoScaleAxis,onlyInteger:true},plugins:[Chartist.plugins.ctPointLabels({textAnchor:"middle",})]});if(window.Worker){const tspWorker=new Worker("/blog/scripts/tsp-worker.js");tspWorker.onmessage=function(e){let result="A"+e.data[0]+"A";const seriesBuilder={labels:[],series:buildSeries(result)};title.innerHTML="Total Distance = "+e.data[1];summary.innerHTML="Average fitness (Blue)/ Best fitness(Red) over Generation";new Chartist.Line(".ct-chart",seriesBuilder,{showLine:true,axisX:{type:Chartist.AutoScaleAxis,onlyInteger:true},plugins:[Chartist.plugins.ctPointLabels({textAnchor:"middle",})]});const seriesSummary={labels:e.data[2][0],series:[e.data[2][1],e.data[2][2]]};new Chartist.Line(".summary-chart",seriesSummary,{showLine:true,fullWidth:false,chartPadding:{right:40},axisX:{showLabel:false},plugins:[]});};button.onclick=function(){let crossOverMethod=cm.options[cm.selectedIndex].value;let selectionMethod=sm.options[sm.selectedIndex].value;tspWorker.postMessage([crossOverMethod,selectionMethod]);};}</script><style>@media only screen and (min-width:1000px){.row{display:flex!important}.column{flex:50%!important}.columnOne{flex:30%!important}.columnTwo{flex:70%!important}.ct-chart,.summary-chart{width:30rem}#cities{display:block;margin:auto;width:40rem}}.ct-series-a .ct-line,.ct-point{stroke:blue;stroke-width:1px}#run{background-color:blue!important}</style><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/blog/blog/october-2019/ga/ title="Genetic Algorithm"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/blog/blog/october-2019/promiseall/ title="Promise All" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/blog/js/clipboard.min.js?1572862398></script><script src=/blog/js/perfect-scrollbar.min.js?1572862398></script><script src=/blog/js/perfect-scrollbar.jquery.min.js?1572862398></script><script src=/blog/js/jquery.sticky.js?1572862398></script><script src=/blog/js/featherlight.min.js?1572862398></script><script src=/blog/js/highlight.pack.js?1572862398></script><script>hljs.initHighlightingOnLoad();</script><script src=/blog/js/modernizr.custom-3.6.0.js?1572862398></script><script src=/blog/js/learn.js?1572862398></script><script src=/blog/js/hugo-learn.js?1572862398></script><link href=/blog/mermaid/mermaid.css?1572862398 rel=stylesheet><script src=/blog/mermaid/mermaid.js?1572862398></script><script>mermaid.initialize({startOnLoad:true,flowchart:{curve:'basis'},classDiagram:{htmlLabels:true}});</script></body></html>